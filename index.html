<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OneG: Organize seus Desejos</title>
    <link rel="stylesheet" href="css/telaum_style.css">
    <link rel="icon" href="img/logo.png" type="image/png">
</head>
<body>
    <header class="navbar">
        <div class="container">
            <a href="#" class="logo">OneG</a>
            <nav class="nav-links">
                <a href="login.html" class="nav-link">Entrar</a>
                <a href="criar_conta.html" class="btn btn-primary">Criar Conta</a>
            </nav>
        </div>
    </header>

    <main>
        <section class="hero">
            <div class="container">
                <h1>Sua Wishlist,<br>Reinventada.</h1>
                <p class="subtitle">
                    Organize jogos, mang치s e presentes em um s칩 lugar. 
                    Compartilhe com amigos e acabe com as d칰vidas na hora de presentear.
                </p>
                <div class="hero-buttons">
                    <a href="criar_conta.html" class="btn btn-primary">Criar Minha Lista</a>
                    <a href="login.html" class="btn btn-secondary">J치 tenho conta</a>
                </div>

                <div class="profile-search">
                    <h3>游댌 Procurar lista de amigo</h3>
                    <form class="search-form" id="profile-search-form">
                        <input type="text" id="search-query" placeholder="Digite o usu치rio ex: eduardo..." required>
                        <button type="submit" class="btn btn-primary">Buscar</button>
                    </form>
                    <div id="search-results-container"></div>
                </div>
            </div>
        </section>

        <section class="features">
            <div class="container">
                <h2>O que voc칡 pode fazer?</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <span class="icon">游꿡</span>
                        <h3>Organize Tudo</h3>
                        <p>Jogos, colecion치veis ou roupas. Crie categorias e mantenha tudo sob controle.</p>
                    </div>
                    <div class="feature-card">
                        <span class="icon">游댕</span>
                        <h3>Compartilh치vel</h3>
                        <p>Um link 칰nico para o seu perfil p칰blico. Envie para quem quiser.</p>
                    </div>
                    <div class="feature-card">
                        <span class="icon">游</span>
                        <h3>Ultra R치pido</h3>
                        <p>Sincroniza칞칚o instant칙nea e acesso imediato.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <script type="module" src="js/firebase-config.js"></script>
    <script type="module">
        import { db } from './js/firebase-config.js';
        import { collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const searchForm = document.getElementById('profile-search-form');
        const resultsContainer = document.getElementById('search-results-container');

        searchForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const term = document.getElementById('search-query').value.trim();
            if(!term) return;
            
            resultsContainer.innerHTML = '<p style="color:#666; margin-top:10px;">Buscando...</p>';

            try {
                // Busca no Firestore por usu치rio
                const usersRef = collection(db, "users");
                // Nota: O Firestore n칚o tem busca textual nativa robusta (LIKE %...%). 
                // Usamos "==" para exato ou ">=" e "<=" para prefixo. Vamos usar exato para simplificar ou prefixo.
                const q = query(usersRef, where("username", "==", term), where("isPublic", "==", true));
                
                const querySnapshot = await getDocs(q);
                
                resultsContainer.innerHTML = '';
                
                if (querySnapshot.empty) {
                    resultsContainer.innerHTML = '<p>Nenhum usu치rio p칰blico encontrado.</p>';
                    return;
                }

                querySnapshot.forEach((doc) => {
                    const userData = doc.data();
                    const link = document.createElement('a');
                    link.href = `public_list.html?user=${userData.username}`;
                    link.textContent = `@${userData.username}`;
                    link.className = 'profile-link';
                    link.target = "_blank";
                    resultsContainer.appendChild(link);
                });

            } catch (error) {
                console.error(error);
                resultsContainer.innerHTML = '<p>Erro na busca.</p>';
            }
        });
    </script>
</body>
</html>